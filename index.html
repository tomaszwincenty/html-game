<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Happy Mrs. Chicken</title>
  <style>
    * { margin: 0; padding: 0; }
    html, body { width: 100%; height: 100%; }
    canvas { display: block; }
    canvas {
    background: #3AC1FB;
  }
  </style>
</head>
<body>

<canvas id="canvas"></canvas>

<script>
  window.addEventListener('resize', resizeCanvas, false);
  const canvas = document.getElementById('canvas');
  const context = canvas.getContext('2d');
  
  function resizeCanvas() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
  }
  resizeCanvas();

  class Chicken {
    constructor(x, y) {
      this.x = x;
      this.y = y;
    }
    draw() {
      var img = new Image();
      img.onload = () => {
        const width = 100;
        const height = 100;
        context.drawImage(img, this.x, this.y, width, height);
      }
      img.src = "chicken.svg";
    }
    move(dx, dy) {
      const randomSign = () => Math.sign(Math.random()-0.5);
      this.x = this.x + randomSign()*dx;
      this.y = this.y + randomSign()*dy;
    }
  }

  const config = {
    inintialCoordinates: [ 
      canvas.width/2,
      canvas.height/2,
  ],
    spawningSpeed: 5,
  }

  const state = {
    actionsCounter: 0,
    chickens: [],
  }

  function spawnChicken(x, y) {
    const newChicken = new Chicken(x, y);
    state.chickens.push(newChicken);
  }

  function action() {
    const { spawningSpeed } = config;
    state.chickens.forEach((chicken) => chicken.move(50, 50));
    state.actionsCounter++;
    if (state.actionsCounter%spawningSpeed === 0) { spawnChicken(...config.inintialCoordinates); }
  }

  function draw() {
    context.clearRect(0, 0, canvas.width, canvas.height);
    state.chickens.forEach((chicken) => chicken.draw());
    // requestAnimationFrame(draw);
  }

  spawnChicken(...config.inintialCoordinates);
  setInterval(draw, 500);
  // draw();
  document.addEventListener('keydown', action, false);

</script>

</body>
</html>